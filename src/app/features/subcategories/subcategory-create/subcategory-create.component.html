<div class="main-content p-4">
  <!-- Create Form -->
  <div class="card shadow-sm">
    <div class="card-body p-4">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h4 class="mb-0">Create Subcategory</h4>
      </div>

      <form [formGroup]="createSubcategoryForm" (ngSubmit)="onSubmit()">
        <div class="row g-3">
          <!-- Image Upload -->
          <div class="col-md-6">
            <label for="image" class="form-label">Image</label>
            <input
              type="file"
              id="image"
              class="form-control"
              accept="image/*"
              (change)="onFileSelected($event)"
            />

            <!-- Image Preview -->
            <div class="mt-2">
              <img
                [src]="
                  imagePreviewUrl ||
                  'https://via.placeholder.com/200x150?text=No+Image'
                "
                alt="Preview"
                class="img-thumbnail"
                style="max-height: 200px"
              />
            </div>

            <!-- Image Validation -->
            <div
              *ngIf="
                createSubcategoryForm.get('image')?.invalid &&
                createSubcategoryForm.get('image')?.touched
              "
              class="text-danger small mt-1"
            >
              <div
                *ngIf="createSubcategoryForm.get('image')?.errors?.['required']"
              >
                Subcategory image is required.
              </div>
            </div>
          </div>

          <!-- Subcategory Name -->
          <div class="col-md-6">
            <label for="subcategoryName" class="form-label"
              >Subcategory Name</label
            >
            <div class="input-group">
              <span class="input-group-text bg-light">
                <i class="bi bi-folder-plus"></i>
              </span>
              <input
                type="text"
                id="subcategoryName"
                class="form-control"
                formControlName="name"
                placeholder="Enter subcategory name"
                autocomplete="off"
              />
            </div>
            <div
              *ngIf="
                createSubcategoryForm.get('name')?.invalid &&
                createSubcategoryForm.get('name')?.touched
              "
              class="text-danger small mt-1"
            >
              <small
                *ngIf="createSubcategoryForm.get('name')?.errors?.['required']"
              >
                Subcategory name is required.
              </small>
              <small
                *ngIf="createSubcategoryForm.get('name')?.errors?.['minlength']"
              >
                Subcategory name must be at least 3 characters.
              </small>
            </div>
          </div>

          <!-- Category Dropdown -->
          <div class="col-12">
            <label for="categorySelect" class="form-label">Category</label>
            <select
              id="categorySelect"
              class="form-select"
              formControlName="categoryId"
              required
            >
              <option value="" disabled>Select a category</option>
              <option
                *ngFor="let category of categoriesDropdownList"
                [value]="category.categoryId"
              >
                {{ category.name }}
              </option>
            </select>

            <div
              *ngIf="
                createSubcategoryForm.get('categoryId')?.invalid &&
                createSubcategoryForm.get('categoryId')?.touched
              "
              class="text-danger mt-1"
            >
              <small>Category is required.</small>
            </div>
          </div>
        </div>

        <!-- Buttons -->
        <div class="d-flex justify-content-end mt-4 gap-2">
          <button
            class="btn btn-outline-secondary"
            type="button"
            [routerLink]="['/subcategories']"
          >
            <i class="bi bi-x-lg me-2"></i> Cancel
          </button>
          <button
            class="btn btn-primary"
            type="submit"
            [disabled]="createSubcategoryForm.invalid || isSubmitting"
          >
            <i class="bi bi-check-lg me-2"></i> Create Subcategory
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
